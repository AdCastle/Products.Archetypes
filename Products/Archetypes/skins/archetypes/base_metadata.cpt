<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en-US"
      lang="en-US"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

  <metal:block fill-slot="javascript_head_slot">
    <tal:block define="macro here/archetypes_custom_js/macros/javascript_head | nothing"
	       tal:condition="macro">
      <metal:block use-macro="macro" />
    </tal:block>
  </metal:block>

  <body>

    <div metal:fill-slot="main">
      <div metal:define-macro="main"
	   tal:define="rejection here/rejectAnonymous;
	   errors options/state/getErrors|nothing;
	   Iterator python:modules['Products.Archetypes'].IndexIterator;
	   tabindex python:Iterator();
	   fieldset request/fieldset|options/fieldset|string:metadata;
	   schematas here/Schemata;
	   metadata_macros python:path('here/metadata_macros/macros|nothing');"
	   tal:omit-tag="">

	<h1 tal:content="here/title_or_id"
	    metal:use-macro="metadata_macros/header|default" />

      <form name="edit_form"
	    method="post"
	    enctype="multipart/form-data"
	    tal:attributes="action python:here.absolute_url()+'/'+template.id">

	<fieldset>

	  <legend i18n:translate=""
		  tal:content="here/archetype_name" />

<!--
 	<div tal:condition="errors" class="error">
          <div tal:repeat="error errors/keys">
           <strong tal:content="error">Field</strong>: <span tal:replace="python:errors[error]" />
	  </div>
	</div>
-->

         <tal:fields repeat="field python: schematas[fieldset].fields()">
	   <metal:fieldMacro use-macro="python: here.widget(field.getName(), mode='edit')"/>
	 </tal:fields>

	 <input type="hidden" name="form.submitted" value="1" />

	 <input type="hidden" name="fieldset" value="metadata"
		tal:attributes="value fieldset|string:metadata" />

	 <div class="field">
            <label>&nbsp;</label>
	    <input class="context"
		   tabindex=""
		   type="submit"
		   name="Change"
		   i18n:attributes="value"
		   value="Save"
		   tal:attributes="tabindex tabindex/next;" />
	  </div>
	</fieldset>
      </form>
    </div>
  </div>

</body>
</html>
