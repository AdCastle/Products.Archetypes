<metal:block define-macro="single_legend">
          <legend tal:define="iconname python: here.getIcon(1);
                              icon python: here.portal_url() + '/' + iconname">
    
              <img alt="" tal:attributes="src icon" />
          
              <tal:legend define="fieldset python:(len(fieldsets) &gt; 1 and fieldset != 'default') and fieldset">
                <tal:fieldset i18n:translate="legend_fieldset_details"
                              tal:condition="fieldset">
                  <span i18n:name="fieldset">
                    <span i18n:translate=""
                          tal:content="fieldset" />
                  </span>
                  Details
                </tal:fieldset>
                <tal:type i18n:translate="legend_type_details"
                          tal:condition="not: fieldset">
                  <span i18n:name="type" tal:define="fti python:here.portal_types.getTypeInfo(here)">

                    <span i18n:translate=""
                          tal:content="fti/title_or_id" />
                  </span>
                  Details
                </tal:type>
              </tal:legend>
          </legend>

</metal:block>

<metal:block define-macro="preload_legend">
          <legend tal:define="iconname python: here.getIcon(1);
                              icon python: here.portal_url() + '/' + iconname">

              <img alt="" tal:attributes="src icon" />

            <tal:buttons tal:repeat="button fieldsets">
            <a onClick="showFieldset" 
                tal:omit-tag="python:fieldset==button"
                tal:attributes="onClick     string:return showFieldset('$button');
                                href        string:javascript:return showFieldset('$button')"
                href="#">
                <span tal:define="
                            is_error      python:test(button in fieldsetsWithErrors,'error','noerror');"
                      tal:attributes="
                            class         python:test(button!=fieldset,'fieldset-label-%s-normal' %is_error,'fieldset-label-%s-selected' %is_error)"
                          class="">
              <tal:legend >
                <tal:fieldset i18n:translate="legend_fieldset_details"
                              tal:condition="python:button!='default'">
                  <span i18n:name="fieldset">
                    <span i18n:translate=""
                          tal:content="button" />
                  </span>
                </tal:fieldset>
                <tal:type i18n:translate="legend_type_details"
                          tal:condition="python:button=='default'">
                  <span i18n:name="type" tal:define="fti python:here.portal_types.getTypeInfo(here)">

                    <span i18n:translate=""
                          tal:content="fti/title_or_id" />
                  </span>
                  Details
                </tal:type>
              </tal:legend>
              </span>
                </a> <span tal:condition="not:repeat/button/end" tal:omit-tag=""> | </span>
            </tal:buttons>
          </legend>
</metal:block>
