<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:domain="plone">

<body>

<!-- Keyword Widgets -->

    <div class="field" metal:define-macro="view">
     <metal:block define-slot="widget_label">
     </metal:block>
     <metal:block use-macro="here/widgets/field/macros/view">
	<metal:block fill-slot="widget_view">
	    <span tal:content="accessor"/><br/>
	</metal:block>
      </metal:block>
    </div>

    <div metal:define-macro="edit">
      <div tal:attributes="class python:test(field.required, 'required label', 'label')">
	<span i18n:translate="" tal:content="python:widget.Label(here)"/>
	<div class="field"
            tal:define="error errors/fieldName | nothing;
	    accessor_name field/accessor;
            value python:request.get(fieldName, None);
	    value python:value or accessor()"
	    tal:attributes="class python:test(error, 'field error', 'field')" >
	    <span tal:condition="error" tal:replace="error" />

	      <script language="JavaScript">
	      function setSelectedKeyword(fieldName) {
		predefKeywords=document.getElementById(fieldName + '_predefined_keywords');
		for (var x=0; x<predefKeywords.length; x++) {
		  if (predefKeywords[x].selected) {
		      setKeyword(fieldName, predefKeywords[x].value);
		    }
		  }
		}

	      function setKeyword(fieldName, newWord) {
		selKeywords=document.getElementById(fieldName);
               	selKeywords.value=newWord;
		}
	      </script>

	    <table>
	      <tr><td>
		  Existing <span tal:content="fieldName"/>
		  <br />
		      <select size="7"
			      tal:attributes="
			      id string:${fieldName}_predefined_keywords;
			      name string:${fieldName}_predefined_keywords;
			      tabindex tabindex/next;">
                        <option value="#" tal:define="keywords python: here.collectKeywords(fieldName, accessor_name)"
			tal:repeat="keyword keywords"
			tal:content="keyword" tal:attributes="value python: keywords.getValue(keyword)"> # </option>
                        </select>

                        <br />

                        <input class="context"
                               type="submit"
                               name="add"
                               tabindex=""
                               value="Set Selected &gt;"
                               tal:attributes="
			onclick string: javascript: setSelectedKeyword('${fieldName}');;return false;
			tabindex tabindex/next;">

                    </td>

                    <td>
                    Selected <span tal:content="fieldName"/><br />
                    <input type="text" 
                           tal:attributes="id string:${fieldName};
                                           name string:${fieldName};
                                           value value;
               		                   tabindex tabindex/next;"/>
	</td></tr>
      </table>
      </div>
    </div>
  </div>

    <div metal:define-macro="search">
      <div metal:use-macro="here/widgets/keyword/macros/edit">
      </div>
    </div>

  </body>

</html>

